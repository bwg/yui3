YUI.add("menu",function(e,t){var n=e.ClassNameManager.getClassName,r="disable",i="enable",s="itemClick",o=e.Base.create("menu",e.Menu.Base,[e.View],{classNames:{canHaveChildren:n("menu-can-have-children"),children:n("menu-children"),disabled:n("menu-disabled"),hasChildren:n("menu-has-children"),heading:n("menu-heading"),item:n("menu-item"),label:n("menu-label"),menu:n("menu"),noTouch:n("menu-notouch"),open:n("menu-open"),selected:n("menu-selected"),separator:n("menu-separator"),touch:n("menu-touch")},rendered:!1,initializer:function(){this._openMenus={},this._published={},this._timeouts={},this._attachMenuEvents()},destructor:function(){this._detachMenuEvents(),delete this._openMenus,delete this._published,e.Object.each(this._timeouts,function(e){clearTimeout(e)},this),delete this._timeouts},closeSubMenus:function(){return e.Object.each(this._openMenus,function(e){e.close()},this),this},disableItem:function(e,t){return e.isDisabled()||this._fire(r,{item:e},{defaultFn:this._defDisableFn,silent:t&&t.silent}),this},enableItem:function(e,t){return e.isDisabled()&&this._fire(i,{item:e},{defaultFn:this._defEnableFn,silent:t&&t.silent}),this},getHTMLNode:function(e){return e._htmlNode||(e._htmlNode=this.get("container").one("#"+e.id)),e._htmlNode},hide:function(){return this.set("visible",!1),this},render:function(){var t=this.get("container");return t.addClass(this.classNames.menu),"ontouchstart"in e.config.win?t.addClass(this.classNames.touch):t.addClass(this.classNames.noTouch),this._childrenNode=this.renderChildren(this.rootNode,{container:t}),t.inDoc()||e.one("body").append(t),this.rendered=!0,this},renderChildren:function(t,n){n||(n={});var r=n.container,i=r&&r.one("."+this.classNames.children);i||(i=e.Node.create(o.Templates.children({classNames:this.classNames,menu:this,item:t}))),t.isRoot()&&(i.set("tabIndex",0),i.set("role","menu")),t.hasChildren()&&i.set("aria-expanded",t.isOpen());for(var s=0,u=t.children.length;s<u;s++)this.renderNode(t.children[s],{container:i,renderChildren:!0});return r&&r.append(i),i},renderNode:function(t,n){n||(n={});var r=this.classNames,i=t._htmlNode;i||(i=t._htmlNode=e.Node.create(o.Templates.item({classNames:r,item:t,menu:this})));switch(t.type){case"separator":i.set("role","separator");break;case"item":case"heading":var s=i.one("."+r.label),u=s.get("id");s.setHTML(t.label),u||(u=e.guid(),s.set("id",u)),i.set("aria-labelledby",u),t.type==="heading"?i.set("role","heading"):(i.set("role","menuitem"),i.toggleClass(r.disabled,t.isDisabled()),t.canHaveChildren&&(i.addClass(r.canHaveChildren),i.toggleClass(r.open,t.isOpen()),t.hasChildren()&&(i.addClass(r.hasChildren),n.renderChildren&&this.renderChildren(t,{container:i}))))}return n.container&&n.container.append(i),i},show:function(){return this.set("visible",!0),this},toggle:function(){return this.set("visible",!this.get("visible")),this},_attachMenuEvents:function(){this._menuEvents||(this._menuEvents=[]);var e=this.classNames,t=this.get("container");this._menuEvents.push(this.after({add:this._afterAdd,clear:this._afterClear,close:this._afterClose,disable:this._afterDisable,enable:this._afterEnable,open:this._afterOpen,remove:this._afterRemove,visibleChange:this._afterVisibleChange}),t.on("hover",this._onMenuMouseEnter,this._onMenuMouseLeave,this),t.delegate("click",this._onItemClick,"."+e.item+">."+e.label,this),t.delegate("hover",this._onItemMouseEnter,this._onItemMouseLeave,"."+e.canHaveChildren,this),t.after("clickoutside",this._afterClickOutside,this))},_detachMenuEvents:function(){(new e.EventHandle(this._menuEvents)).detach()},_getAnchorRegion:function(e,t,n){var r={};return e.replace(/^([bt])([lr])-([bt])([lr])/i,function(e,t,i,s,o){var u={b:"bottom",l:"left",r:"right",t:"top"};r[u[t]]=n[u[s]],r[u[i]]=n[u[o]]}),"bottom"in r||(r.bottom=r.top+t.height),"left"in r||(r.left=r.right-t.width),"right"in r||(r.right=r.left+t.width),"top"in r||(r.top=r.bottom-t.height),r},_getSortedAnchorRegions:function(t,n,r,i){i||(i=e.DOM.viewportRegion());var s=[],o,u,a,f;for(o=0,u=t.length;o<u;o++)a=t[o],a.point&&(a=a.point),f=this._getAnchorRegion(a,n,r),s.push({point:a,region:f,score:this._inRegion(f,i)});return s.sort(function(e,t){return e.score===t.score?0:e.score===!0?-1:t.score===!0?1:t.score-e.score}),s},_hideMenu:function(e,t){t||(t=this.getHTMLNode(e));var n=t.one("."+this.classNames.children);n.setXY([-1e4,-1e4]),delete e.data.menuAnchor},_inRegion:function(e,t){return e.bottom<=t.bottom&&e.left>=t.left&&e.right<=t.right&&e.top>=t.top?!0:Math.min(t.bottom-e.bottom,0)+Math.min(e.left-t.left,0)+Math.min(t.right-e.right,0)+Math.min(e.top-t.top,0)},_positionMenu:function(e,t){t||(t=this.getHTMLNode(e));var n=t.one("."+this.classNames.children),r=this._getSortedAnchorRegions(e.parent&&e.parent.data.menuAnchors||["tl-tr","bl-br","tr-tl","br-bl"],n.get("region"),t.get("region"));e.data.menuAnchors=r;var i=r[0].region;n.setXY([i.left,i.top])},_afterAdd:function(e){if(!this.rendered)return;var t=e.parent,n,r;if(t===this.rootNode)n=this._childrenNode;else{r=this.getHTMLNode(t),n=r&&r.one("."+this.classNames.children);if(!n){r||(r=this.renderNode(t)),this.renderChildren(t,{container:r});return}}n.insert(this.renderNode(e.node,{renderChildren:!0}),e.index)},_afterClear:function(){this._openMenus={};if(!this.rendered)return;delete this._childrenNode,this.rendered=!1,this.get("container").empty(),this.render()},_afterClickOutside:function(){this.closeSubMenus()},_afterClose:function(e){var t=e.node,n=this.getHTMLNode(t);for(var r=0,i=t.children.length;r<i;r++)t.children[r].close();t.close(),delete this._openMenus[t.id],n&&(this._hideMenu(t,n),n.removeClass(this.classNames.open))},_afterDisable:function(e){var t=this.getHTMLNode(e.item);t&&t.addClass(this.classNames.disabled)},_afterEnable:function(e){var t=this.getHTMLNode(e.item);t&&t.removeClass(this.classNames.disabled)},_afterOpen:function(e){var t=e.node,n=this.getHTMLNode(t),r=t.parent,i;if(r)if(r.isOpen())for(var s=0,o=r.children.length;s<o;s++)i=r.children[s],i!==t&&i.close();else r.open();this._openMenus[t.id]=t,n&&(this._positionMenu(t,n),n.addClass(this.classNames.open))},_afterRemove:function(e){delete this._openMenus[e.node.id];if(!this.rendered)return;var t=this.getHTMLNode(e.node);t&&(t.remove(!0),delete e.node._htmlNode)},_afterVisibleChange:function(e){this.get("container").toggleClass(this.classNames.open,e.newVal)},_onItemClick:function(e){var t=this.getNodeById(e.currentTarget.getData("item-id")),n=s+"#"+t.id,r=t.isDisabled();(r||t.url==="#")&&e._event.preventDefault();if(r)return;this._published[n]||(this._published[n]=this.publish(n,{defaultFn:this._defSpecificItemClickFn})),this._published[s]||(this._published[s]=this.publish(s,{defaultFn:this._defItemClickFn})),this.fire(n,{originEvent:e,item:t})},_onItemMouseEnter:function(e){var t=this.getNodeById(e.currentTarget.get("id")),n=this;clearTimeout(this._timeouts.item);if(t.isOpen()||t.isDisabled())return;this._timeouts.item=setTimeout(function(){t.open()},200)},_onItemMouseLeave:function(e){var t=this.getNodeById(e.currentTarget.get("id")),n=this;clearTimeout(this._timeouts.item);if(!t.isOpen())return;this._timeouts.item=setTimeout(function(){t.close()},300)},_onMenuMouseEnter:function(){clearTimeout(this._timeouts.menu)},_onMenuMouseLeave:function(){var e=this;clearTimeout(this._timeouts.menu),this._timeouts.menu=setTimeout(function(){e.closeSubMenus()},500)},_defDisableFn:function(e){e.item.state.disabled=!0},_defEnableFn:function(e){delete e.item.state.disabled},_defItemClickFn:function(e){var t=e.item;t.canHaveChildren?(clearTimeout(this._timeouts.item),clearTimeout(this._timeouts.menu),e.item.toggle()):this.closeSubMenus()},_defSpecificItemClickFn:function(e){this.fire(s,{originEvent:e.originEvent,item:e.item})}},{ATTRS:{visible:{value:!1}}});e.Menu=e.mix(o,e.Menu)},"@VERSION@",{requires:["classnamemanager","event-hover","event-outside","menu-base","menu-templates","node-screen","view"],skinnable:!0});
