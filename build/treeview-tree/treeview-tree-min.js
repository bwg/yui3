YUI.add("treeview-tree",function(e,t){var n=e.Lang,r="add",i="clear",s="close",o="open",u="remove",a="select",f="unselect";e.namespace("TreeView").Tree=e.Base.create("tree",e.Base,[],{_isYUITree:!0,_rootNodeConfig:{canHaveChildren:!0},initializer:function(e){e||(e={}),this._published||(this._published={}),this._nodeMap={},this.clear(e.rootNode,{silent:!0}),this._attachTreeEvents(),e.nodes&&this.appendNode(this.rootNode,e.nodes,{silent:!0})},destructor:function(){this.destroyNode(this.rootNode,{silent:!0}),this._detachTreeEvents(),delete this.rootNode,delete this._nodeMap,delete this._published,delete this._selectedMap},appendNode:function(t,n,r){return this.insertNode(t,n,e.merge(r,{index:t.children.length,src:"append"}))},clear:function(e,t){return this._fire(i,{rootNode:this.createNode(e||this._rootNodeConfig)},{defaultFn:this._defClearFn,silent:t&&t.silent})},closeNode:function(e,t){return e.canHaveChildren&&e.isOpen()&&this._fire(s,{node:e},{defaultFn:this._defCloseFn,silent:t&&t.silent}),this},createNode:function(t){t||(t={});if(t._isYUITreeNode)return this._adoptNode(t),t;if(t.children){var n=[];for(var r=0,i=t.children.length;r<i;r++)n.push(this.createNode(t.children[r]));t=e.merge(t,{children:n})}var s=new e.TreeView.Node(this,t);return this._nodeMap[s.id]=s},destroyNode:function(e,t){var n,r,i;t||(t={});for(r=0,i=e.children.length;r<i;r++)n=e.children[r],delete n.parent,this.destroyNode(n,t);return e.parent&&this.removeNode(e,t),delete e.children,delete e.data,delete e.state,delete e.tree,delete e._htmlNode,delete e._indexMap,delete this._nodeMap[e.id],e.state={destroyed:!0},this},emptyNode:function(e,t){var n=[];while(e.children.length)n.push(this.removeNode(e.children[0],t));return n},getNodeById:function(e){return this._nodeMap[e]},getSelectedNodes:function(){return e.Object.values(this._selectedMap)},insertNode:function(e,t,i){i||(i={}),e||(e=this.rootNode);var s=i.index;typeof s=="undefined"&&(s=this.rootNode.children.length);if(n.isArray(t)){var o=[];t=t.concat();for(var u=0,a=t.length;u<a;u++)o.push(this.insertNode(e,t[u],i)),"index"in i&&(i.index+=1);return o}return t=this.createNode(t),this._fire(r,{index:s,node:t,parent:e,src:i.src||"insert"},{defaultFn:this._defAddFn,silent:i.silent}),t},openNode:function(e,t){return e.canHaveChildren&&!e.isOpen()&&this._fire(o,{node:e},{defaultFn:this._defOpenFn,silent:t&&t.silent}),this},prependNode:function(t,n,r){return this.insertNode(t,n,e.merge(r,{index:0,src:"prepend"}))},removeNode:function(e,t){return t||(t={}),this._fire(u,{destroy:!!t.destroy,node:e,parent:e.parent,src:t.src||"remove"},{defaultFn:this._defRemoveFn,silent:t.silent}),e},selectNode:function(e,t){return this._selectedMap[e.id]||this._fire(a,{node:e},{defaultFn:this._defSelectFn,silent:t&&t.silent}),this},size:function(){return this.rootNode.size()},toggleNode:function(e,t){return e.isOpen()?this.closeNode(e,t):this.openNode(e,t)},toJSON:function(){return this.rootNode.toJSON()},unselect:function(e){for(var t in this._selectedMap)this._selectedMap.hasOwnProperty(t)&&this.unselectNode(this._selectedMap[t],e);return this},unselectNode:function(e,t){return(e.isSelected()||this._selectedMap[e.id])&&this._fire(f,{node:e},{defaultFn:this._defUnselectFn,silent:t&&t.silent}),this},_adoptNode:function(e,t){var n=e.tree;if(n===this)return;for(var r=0,i=e.children.length;r<i;r++)this._adoptNode(e.children[r],{silent:!0});n.removeNode(e,t),delete n._nodeMap[e.id],this._nodeMap[e.id]=e,e.tree=this},_attachTreeEvents:function(){this._treeEvents||(this._treeEvents=[]),this._treeEvents.push(this.after("multiSelectChange",this._afterMultiSelectChange))},_detachTreeEvents:function(){(new e.EventHandle(this._treeEvents)).detach(),this._treeEvents=[]},_fire:function(e,t,n){return n&&n.silent?n.defaultFn&&n.defaultFn.call(this,t):(n&&n.defaultFn&&!this._published[e]&&(this._published[e]=this.publish(e,{defaultFn:n.defaultFn})),this.fire(e,t)),this},_removeNodeFromParent:function(e){var t=e.parent,n;t&&(n=t.indexOf(e),n>-1&&(t.children.splice(n,1),t._isIndexStale=!0,delete e.parent))},_afterMultiSelectChange:function(e){this.multiSelect=e.newVal,this.unselect()},_defAddFn:function(e){var t=e.node,n=e.parent;t.parent=n,n.children.splice(e.index,0,t),n.canHaveChildren=!0,n._isIndexStale=!0,t.isSelected()&&this.selectNode(t)},_defClearFn:function(e){var t=e.rootNode;this.rootNode&&this.destroyNode(this.rootNode,{silent:!0}),this._nodeMap={},this._selectedMap={},this._nodeMap[t.id]=t,this.rootNode=t},_defCloseFn:function(e){delete e.node.state.open},_defOpenFn:function(e){e.node.state.open=!0},_defRemoveFn:function(e){var t=e.node;delete t.state.selected,delete this._selectedMap[t.id],e.destroy?this.destroyNode(t,{silent:!0}):e.parent?this._removeNodeFromParent(t):this.rootNode===t&&(this.rootNode=this.createNode(this._rootNodeConfig))},_defSelectFn:function(e){this.get("multiSelect")||this.unselect(),e.node.state.selected=!0,this._selectedMap[e.node.id]=e.node},_defUnselectFn:function(e){delete e.node.state.selected,delete this._selectedMap[e.node.id]}},{ATTRS:{multiSelect:{value:!1},rootNode:{getter:function(){return this.rootNode},readOnly:!0}}})},"@VERSION@",{requires:["base-build","treeview-node"]})